# -*- coding: utf-8 -*-
"""Копия блокнота "lesson2_homework"

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kf9nXK446N8Y88-JxhlKssY4If5qaV82

# **Домашняя работа 1 (21.04)**
"""

#установка библиотеки
!pip install psycopg2

#проверка подключения PostgreSQL 
import psycopg2
import pandas as pd
 
DB_HOST = '52.157.159.24'
 
#####################
#!введите свои реквизиты!
 
DB_USER = 'student19'
DB_USER_PASSWORD = 'student19_password'
DB_NAME = 'sql_ex_for_student19'
 
conn = psycopg2.connect(host=DB_HOST, user=DB_USER, password=DB_USER_PASSWORD, dbname=DB_NAME)

"""Рассматривается БД кораблей, участвовавших во второй мировой войне. Имеются следующие отношения:

*   Classes (class, type, country, numGuns, bore, displacement)
*   Ships (name, class, launched)
*   Battles (name, date)
*   Outcomes (ship, battle, result)

Корабли в «классах» построены по одному и тому же проекту, и классу присваивается либо имя первого корабля, построенного по данному проекту, либо названию класса дается имя проекта, которое не совпадает ни с одним из кораблей в БД. Корабль, давший название классу, называется головным.

*   Отношение ***Classes*** содержит имя класса, тип (bb для боевого (линейного) корабля или bc для боевого крейсера), страну, в которой построен корабль, число главных орудий, калибр орудий (диаметр ствола орудия в дюймах) и водоизмещение ( вес в тоннах). 
*   В отношении ***Ships*** записаны название корабля, имя его класса и год спуска на воду. 
*   В отношение ***Battles*** включены название и дата битвы, в которой участвовали корабли. 
*   В отношении **Outcomes** – результат участия данного корабля в битве (потоплен-sunk, поврежден - damaged или невредим - OK).

Замечания. 1) В отношение Outcomes могут входить корабли, отсутствующие в отношении Ships. 2) Потопленный корабль в последующих битвах участия не принимает.

![ships.gif](data:image/gif;base64,R0lGODlhxwECAaIGANTQyP///wAAAAYAAICAgP//AAAAAAAAACH5BAEAAAYALAAAAADHAQIBAAP/aLrc/jDKSau9OOvNu/9gKI5kaZ5oqq5s675wLM90bd94ru987//AoHBILBqPyKRyyWw6n9CodEqtWq/YrHbL7Xq/4LB4TC6bz4O0es1uu9/wuHxOr9vv+Lx+fe47BwCBgoOEhYaHiImKi4yNjo+QkZKBA36WSoCTmpucnZ6foIKVl6RFmaGoqaqrrIajpbBAp620tba3iK+xuzuzuL/AwZ+6vMU2vsLJysu5xs7HzNHS0cTP1i3IhgIC093endXX4ijI2+aB29/q647h4+8jvumC3PPs9/iD7vD8HvLc9ADYO4duoMGD+RKC2tevYYZ/heYBTCdR4ESLBTEKVMhx/xNDhyApQCRkL2PJkxPrAezIUtLHkDAfjBwk0VzKlQRt1lzZsueilzGDKpi5kWJKmjyNHirps2khoEJjElWpkaJJkzg3anTKVV/UrxDK2cxoMSfCgme7qgUAFazDbGvj3mrrth9cuXhZ0a0L727ev6H28h3nF7BhToIHX8tEoLHjx5AjS55MubLly5gza97MufNmUYrBMo7Es2fpfKc7rUwc2tloSKk7xmY3W9Pq1lFfP6pNUh3vb797176NO6huR0kJ9uY0UDU95REX6UyVPGD04aCLSw1EgLR1RMEVNWf+PXb48N6ff6epdWl27SGPN7oYsWLWcztL10OHtn9a/v8AAmjWTdqUVxZOTLkX0EX3aQVde6zBB4t8jNDHHn/7YShge0k5KNyGWRm4XlEFLsfhiSEm0iGDC5JYIlsSxsddeqc12KCHKeKIVoYMjiWigPghleCKAar04Is62rjVhTDG+NaMsAVoYIYusiglizdaGd2VKP64Ho8tInfhfkqS9V2ETlpCoXQjllmlhlxeBaeWHRZpZ4o1mnhje+AxaZWGdZ6ZZkNriickgQ4GqWOcVSlK34MIolTTjluWp9yRSCJIKZlDvjfoO4WqyBV6tjEpCanzefqpOKH26RSqp5qaXijErUoYlLuNyhKsbFJiK6i4ivnqrtSp+qtr3Omk7LL/zDbr7LPQRivttNROO0e11Bp7bDGtLhXAt+CGK+645JZr7rnohgtAuuy26+65677Lrlc57GHvvfjmq+++/PKhQbfayCvwwO/GS/DBBxuMsLj04lDYYRA/klih09FUrgALZ9yuwgRj/K7H6IKsrsYMazvDwxGnrMjEwdJTwMsvJ3UxyTSXy/HAIqfrsU7fmgNuzgHcnHHDDNj0AsoqJ/3UBmsKEHPMFpMLdM00Cy3v1ObuLC7IWjNMddDGOh2zAAZgRrY/SqfdDtMtowMz1PSE6/PO2/xcdwA+f73xz3zjfTfGdAOet99aA9734Vx7TbVXOr09uLkEnN0B0morzTIA/91pA7N+h+O9teed6z0v4p//LXfogvdst+mqtw6u1QjrI/bbBTjtsyKRf0B55SpfnrnmNXYeeOo9Yy06uQobXnzdiZNOuPKgl+78618zXvv1m9dNWdC5o83790v/27bLtZMkfPRcp398usmDnnjzrkMvv9Tohw57wtmRrX/2BjRLAPeS4wDKEgQ+vPgOPOUzn+s8B7/oOXB9yPtc/OpHuvdNb34LDFr1tGU0CfwPcwFkG0l8NCReFVAdB1wK3OK2OvfN7W93g6C5OCYymzhwbn2zYQ1buLzQaXBxJrPAB7s3uRGyh4AnXEsKgRcRGa7vfnoz3riABsWBEU0DQwyh+P+QckQjYaUszzFhEuciwt8hiYVO1FsVvyZFH/6wZlfMQBZ1Z8QRHsUod7TQGL+xROSkUXRr/CP7NuirDszRe4c6yhcNsqQ9orCMpBFk9SS5sEAWLIgVOGQRwUOVRWoKjI585BYjh61QcgVNmhSgiTDCSKWYqZGmZEYf50NJONYyYYRsEgdSKcIvdZKVv/wTEmMpjFlW6JYksyQyRwbEQu4SgHS046Q86SNQElMaxpTOMoeWsTZOkX6DbKYuN8DLLW5imNfsRjbF48ZthhNh3jxdDzMYQXGiEpqItI0Y00nGUUaSnu5858HimcOCokuZG8MkBcr5EH6mbJ0qauH7Bvf/uFoarHl5U94LY5hRBoLzgeNC6LwUOgGGYmB3DvUJRMFzwfo1kJIXRZ3fFvhS4gFth/DK5T1BGE3P+PSnQA2qUIdKVMiQVCbjYydN3cc3niGzfelj3vlap0OZynOGOvWASS8AsEqZRjbFcuZJkxrRpXbNowGF6gQbaEHVsfWbObWnVvG5STOmqin7BEZeX7RSb2UQfhi8JQ0rOFW0GvalAGUmHI8aga1aoKurNJQ39ooLVFGJr5CEjdwAS9EYClaCy4Me4ShY1RzaEKQhzaoh6apKzM3qQGc8VY5iRSkFqaian6iOlMJk274G7KOoTaskjedNkbKPsRBwbAUg6yfJ/55ztrOC7m5dhQrd8om3mPWnZoFLUJhScmrxNO5BkfsA5YqErK5KTU5Q5ErcvgmU+IlUc60zoP5U6j6XQieX6FQlptRqrK7dbkCtOOC9yXW1PPWeXSs0XTeByUV8enCY+GunNl23wVPiLW+IBGEyXThAvm1igQUm3s8e+JkJriuN7tthD7WYvokSJoaqmaObXNa9EXZxUXC8Siy16JdM8h22KJtSW+yUiK1dcK/yBKgJwynHJMrSk+f7ZCpBl8N76hWIuvRJQWl3NyMmcZgPqloUIzmzudqtg11sZT+1+VEnqrCO24xhKtOZuhx6M5S93NAAg3nM7iqxRctMTtaiWf9YtV0vbOFcY/UsekPWzLOkFIlj/YRRvs7N86Z2zORxchW9fgX06BbW3cSCVrFVI68DzDsB5o6IWLQI1Gtzq+qhgPq33Rw0qT/Gw9HSU9A2qzUDWC0BV08XrLGWVZppJWxjC4Rkpa5art11VgxSkdBYNPSXEf1VjhA5yIemJQ876taMSjWwtpygrzXKvM4WDrWBzRmwkSfsBRA7As7+djD0nezqNvvWIr5hUwfuVrupe3HTK/dS/zpTkFbbftiWo7b7TMohW/ziGM+4xjfOcXuEWIECL7jID3u6aAe65KtDN0ZxyPCDyzviGLh3WAAOclHH1eaoTua//ezHhZO8rQL/N7mBRQ50nP68sBR84LxDWm8FyBypPBc3zrE6deqdGMBKVmrIjz7ynAl96C5PuksJLvakv/zq2U5xkpfi3q8Ld9e81llq0f5Ymkdtnu62tmiDq7HBpvyGUqUqywVvbsQuvWRiTfuZt02+zd296nOHZ9ydSlHFLTbxdY/6Mdfn9lH/sbvXpnvMJ451zWFPZpCvp+Sp3XKm5rzvO896WY/XeYGmMZ5TO7y6ml420n9a8wKhHeqfN+529/qPMSU80dvNUdOh2+yvH1rs/5n6yENe96/j/dMdQDHH372mrn++DJP/QJte1esNj+rDF4j9b8VxuXZHY/Wjb/P2gw3zo1d7/7hpksDvmzbwhXNayIdyoSV2Kxd48AZ9Vnd5npZ5FZctRZYQR6ZFFIdA/YcOhEV0I+ddBFd05zd2ABVv9Bc70ydg87eA1wdzF7B9DRAqthNwHtg14gdBfgeCWzc/gEV2DWR/73dewKd1J+h+88eD2ud7DmiBnKNupSWDnpVGNUh8NYSAw3ODzfdSRIh/Pih7LBWEKFh1V9iA+bd4FahCwcOFb3R7rDeC+IOFrRZ/GNhNFTV+CZc1wDVJVzNebJhJRgh/P3hstbdM9id3gqiGBNODbdiHW7h6usZ3cQdIV9NGhqiH+sd4m8eFgeiIopeF1HdaE2V+oCU4VchNPQSKD/9HivNkhzOzWceVhwu1h5pogid4iWqkgoeohaEWg1TlcDrIiPJCfjg4cEA3i3RocKsIhivoirU4ZBGIDx/nf10Xfi70iwrXdxnIVO+2gagoNYgVbKxYUshYbG74bGYoi9moc90IdbaIa7hojQRIcsUjijZ4jdKIicPYhDNUhJM4hn9midX3hc2IRusog7v4VpVUjTkYjOU4RXF4j+fYWN+Ib+GINX8oh3CXhiFjfeZojLW4if+nUfFTeDhojwRmcCL4jA2XkAp5SQ2ZXA85c4gYaqcmavNWasMTOBCXiRsJi7HYiCZ2LtEWia2Yj6Wnk6ZWYDM5eZ+YQf64f9pkhmf/OIg9mWorWV4tiY7UN1o2iXci6US+iHfRSHxe+Xw52IWwN5ULkG9O+ZRTt5QIZhk6sQBviZY+t4ETGTtz6IkHN43qF3ZkKX1maWsviWv82I+0KIk+GYVRKJchp0Pq81TtWFo3WIDbWJJCiJPgCEKltIzMOFfigZibpZg7xFnEyIEaaJJrtYvfNJaVyYD/+IbjOISFuVCX4VmPsw2g+ZhXxYvHU4MeaJAK6I4OxJb62HOvSZiWSQFDBpdGo5hYKZkwVJcjKTyD15yEJ1pR1Wtnx5pMqXXQOYAC050FE5tHE5FOSY516JOWJ5UaeZnpCINBaFzgeXJ3CC+8RwLMuZPD/8UuoaedlNiUujlm8BmV+gmJ9RkP5FmcKXicLtmeICeAHZWVjrl81/mfwpiKo8mQ6wkD9wmbqSecQ7mPMbh+Pck65UehKCmdI/WX5JAsmamZojScUreOzxOf4fmRIGmiCJc120hvKnoCG2qcCcqfMFqJMkqj0Ql+2Oid9UhQQDmegRlw7wmk6tma4hiPv7mIB0l2kgRFAliMaGKfB4qjFgqVhSh5RoqRZZmhC7qJ7kZTW6mknimZAqqNKqmmLnCbFUmm0YkzhpWb8GiR3Gin3Bemg9mheoqHgsoCeKqIh9qLZjqMyfSIiEqlZ8qVHCqkN4Cn5MZAbeqgVfiHycN8J//5oJz6nJEKqe84qds5e4UapFOqA4v6jMFYpPCIU2dVcIaDkAWJqm+6eyr6o1LqheJ5p2E6hTLqUpAJqqMpkFDoUbpqlzraTkz3qyxaLS56D19qoE/aoFY6q1padns6UwJpQbn6rbu6pAlFrdv6eFEarGmarSJwm7RqdPOorNLDjrjKdaeqo72KeInKAMBqqO7ql/+qApp6owdIWp9aq6zDhOfmjv0qn4dZp5R6nmO6iK6akfAaAgErrAKLnhS7qonYjqjKeTbjRpUqZvOJoRsLAh27lgNbSSW4j35asrR3siA7YAjVr01KrOsqf/iZse8qsjC5hMznsMVnk6EIlnH/GFOcGLFOmLOpSp89agIvi3PmmW6Y+nsM6ozO+oHoR6/QeKyKNY9vN6ZQ27PYUK0QeK3eULGnyVEdOJ08M67JGlxOa66AOLFF6asFmwIo5bab2Z/cqYO/6K3ydI3VaHlm605cOrWqWi+CGxdwa4NHh7hopbiNu4Cbu7eHCbXuV6DxOrlKRLSCWVU3Go1ZSW5Iq7CRp3c6qzOlpraK2i+2e7u4m7u6+wamC6WNGqEfa7ORuy3PcLU1u01Zq7WvSrzFS6jtGrway7zN+7Ou2aoeu7XSGwuMoYykq07ZawyB273r0LLfewXhK758VL68cL7o673qq727G7/yO7/0Swfv/3u/+Ju/+ru//Nu//vu/ABzAAjzABFzABnzACJzACrzADPxY9fvAEBzBuAurElzBFnzB9mtO7atSsLrBHKzBHswS5JtPIawQl1PCItzBKMwRJ7zCJqzCLpwPLRzDg+swNCzDvXTD2ArDOvyiANbD7DDCmwTE6QvCROy+NqwK+nXEhzDDB6JfS8zEkCDErXVp6IQSjibFawPCWMxJWrwQPLwVw9TFsPTFzcDF1dFKJDQg+eFFtRVpHkzFOSzGmDYddmxjYWTG6prFwORojJTF7ZVHX/Rh4ivHaOzHZEHGgVwVejzDWPzHf2wmi9zHlLzChtxnVlwjiiTJneRKevy3Bv8wFcG0yYrcyXm0xvzmSJf8w5y8I5tMx0+MKGbsyGn8SZEMy9PkyXUUwqv8e4Bsyq+kxmzXyHP8yIhyy8LcKGKcKCjcy5n3y8q8JMncX8RsxMqSx2eByrlMafmVynvkzHyYyVacx/6Bx/Y1y3P8ycUUxur8C07czu7MzvBsZOk8z/2UxPaMC++cz7QAzj7Iz/Q8SkU10ARd0AZ90JQhuhzLHQjd0A790BCd0Orata+GbBYNCv8FDdRLyArhzauQyhl9hFGCVy0B0grtshE5LN4WVqCcb9wmDR7NCpbF0RCiwhR9bLY1DTHN0qmCHRP9Wjy2V+NRKm/sVWyHKc4ByAX/4tOg7KMpfWmxRRrStWxQndNHHcUMptTXISo/PdI0/dUVMtWINtXnIdNc5Ic0HdI04NI4XdGwIdZ3RWWRhWdJLclLzdUt/dTqZR8LEsj+xWY7QceBUif1BcdyZiSYpmVvUiaQctI9tWL1wV/xVdTvVV//0WkxZl+Ygiewdc5eBSaM/dddnWad5mFzUmVHpGZsFmesfV2X9WqcvSfBgWVcRshqfTJ6zWJ6tig5pkeVzdqYbWnqxWKoTdap3WKmXSmUWmdR5mQvtmWPhiM09iWbVtWmImGIPdtjgtw7ll1JfNM6lmFS9tyLMhaMNt09Vt2U3dt3wmNQltweRkC3nZOk/63bXcLbhM3dvC3Xu93a+3UnXp0kP8bHNS25G+3btX3a5O1jCv7azK3f/s3e943XAt5kr1TgQ6pllmbhv91octLhPxIisg3beqJhWV0keiZrGJ6pT+3aA97gra0p431npQ3gcmZhNm7bbpbgqj3a3IbKQCJjC+7HjhLkbjZpiXwkG97Zhp3TthwkbgxuBg7eyRHYMfZgd6Zp0f0oJxHZVc7NnXLkif3ZRG4VUc5nH/rSsNYKKj5rnjDfMcDWPrHT6R3gtObjcd1tbK5sdv7mjq1gbn7R/dbWdO3neH7ier7S/la1JSDniY4aLL3cJL3mGP3nKtbngo4PJj3RHdfpnv/+6aCuE23w6ZaeZKF+6qie6qouLTNLnM8LvUM75VcZtNe7vBkOhLQutATrz/Tt6rmOtcM6qD9YMUArrUY5bYAqvGq56zZ91UlovXzKkzbroVxret5XvX6asuEa7e1Sk6eYe8EeAh3UguMzOytUpa/eMY3YpkoZ7gBb7k9zgRJZ6+qehuiXi2jK7FqVGduwOcKuZGIT8Ox6qQOFlCaZnbae5o137p7JiWCJvM5DqljJ7uXaeobn7lQpu+Yel/DuON9H8cZ3inD6fxL68KQKXldK7SIdEdfummI7g1t6l+n3gSVXbZt68QrqjYWgkLZDOzHTfedepeA3rsZeoUN/q0f/T08iKjIqz4ey94INmqU7KkhqJac+Z6woe6WrmfCF9i2PwfOOcz1k44IX6PIdObZdaqmGK4U0f7c0L3ZN/4qm9+zvSK5Fr/alCZzdmvWq2Zcyy+i9F1rN4u/6A5hPH/RZWpp7R/UE2JunaZqRyX4Yb/gIVIa4CfOM//YqN5At1fdbH71z1TMTMO7v3odQ77XSqLkxr/kGyPl5mfKTH8pkJfAfX4oP77nSiYDUqbpUOKGoFffHKPqXPvfcWp3Q6GuZn/vWyfbN2pEQivCgf+vBZ/n6OWLJe7wX+/mxvlrCv3Zk6LsE70Sgl57Rr/Bzje6/i7Fo2KjAL0Q/A+iFjv7h/y/+1U/+22/+/pnu9H7/XY8AIcbtD80AgNCLMxah+w+G4kiWpgec6sqSaatiQ0Q7U6XlGQf3/vr6CYfBIUhWSzoInoUyebPopjyj9Ve8akfZK/IJiQrG5LK5PE2r1+y2+w2Py98zcI3ZcdrDFML5fzYnOEhYaHiYU7fHEBVXtQVp0hVJOWn0tfjAVKGXydjnSCnKNSpqSXShuNgI91g6evpKVJnqqRnAadvA+uYqGxn7CxPsg7kKmmO20+TjK9xBfOJcMg0yHT1cq8uw6bctgdzbNGYNQyY8Wf1MCqydybtRIC8vsMFMfa+wHoKNz1J1Lg+5PCL6sTBmq1snT/DaAP8U4Uydvl/pIJJ4CIsWBVV7GlIQQI+ePYL+JprcB82KxHImOWB0ZhCIO10Kv3lcg5GlzhErvVgMUa2nlZgxZnYMF29egXoXAAZUMPCcVIFCtQR5GXWi1KcBXZ5kltMX0RNIzDQwSyCtWrW4vG27qSYn1Kh0eTz9mnFcXap85+rbqheLRgAc7cAFKXJky3JhFz+7mo9g1nyuXNoFStLxh7GSUg3sK7BErrdIHVKO/Pd05leQV6fO7FUyydh4YwwuDAYuAJBMFWMl19jMuiK0y2h2bFyuZuW4bn/2O64ghQBudemmolrrVKqfq86Czb1lcrCz5z4/eNuWbsS9P55+GBz/ZUryi+XCp3/yUeMjzvU/P9/BWgrYVBob+72GYETovIdfZfRd5l1B6TFUYFNLaRCfbOAxV0oWGebX4HI6MceZaLWYxYBZgKBoXYVxZVeciK7lVV+IGr4GIWpATPiOi7sl1pReTtEVml0AsrbTeIH9Rpt2XXUnYTsbfUPlA9fpYN+TREI3oykfGGdeaFwCp9VsR9omJWHq+cgbhvJtUeIPVcHEY5VUXpmMjkJEKNibxdR5FA5U5OnnUPL1dA2gdrYoqDigyXkmMIX2ECcXRhnmI3aTfrdpC5VKN+Wid2aKZadCfDqcormRSqiplLqKXpq4iXpMo27wCSuqj6n6hBgr/66ISLDCDkusIbPSiiknvwJSbLPOPuvssVCw6iasw1iLJiQIIVsrtN5+C+630taAZ7XY7niuaLxy22u47r4LbyHj0lDuMkbg6tO95qiQqKzsrhlvwAIPnAjAUjg6RJO76vvPl19Cyc+6/5I7QMUWX4xxxhpvzHHHHn8Mcsgij0xyySbPG0G9iu1ZmyyfeueUanT6O3HNNt+Mc84600utvTh2R6Zsd1Ekc1ZGWgZ0jg6CN6Oum126c9RST0111SoHKeZ9DOLLqXKWreY1VK4dKJbEVZ+Ndtpq13rwrZQlFx/Xpzo8ZIxFB/0V2RHTvHbffv/999XuMW1NjAov+KCNG/UqTjiJZgMOeeSS0yr4bjDSTZ7cfV5uX4hhN763tlBPTnrpprMdCth7hWfkPh4+jLdfTIIIGldRih7q6brvzruVPa+crrr7zHk7nKP3jnzyfleu+aRONywNO7irqXz11q/NfPDZas8f39d/D77O2XMvPPmbPR5++uqTpuyygRAMf/yDoLx+/fYrcYP8+u8f7f3+/x8o/glwgMYCoAEPyAcCKnCBcKAfAh94vZNJcIIUrKAFL4jBjEFwgxzsoAc/CMIQinCEJCyhCU+IwhSqcIUsbKELXwjDGMpwhjSsoQ1viMMc6nCHPOyhD38IxCAKcYhEtF4CAAA7)
"""

#checking
request = """
select *
from battles
where date = (select launched from ships)
"""
pd.read_sql_query(request, conn)

#checking
request = """
SELECT * 
FROM classes
"""
pd.read_sql_query(request, conn)

"""Задание 1: Вывести name, class по кораблям, выпущенным после 1920 """

#task1
request = """
select name, class
from ships
where launched > 1920
"""
pd.read_sql_query(request, conn)

"""Задание 2: Вывести name, class по кораблям, выпущенным после 1920, но не позднее 1942"""

#task2
request = """
select name, class
from ships
where launched > 1920 and launched > 1942
"""
pd.read_sql_query(request, conn)

"""Задание 3: Какое количество кораблей в каждом классе. Вывести количество и class"""

#task3
request = """
select count(class), class
from ships
group by class
"""
pd.read_sql_query(request, conn)

"""Задание 4: Для классов кораблей, калибр орудий которых не менее 16, укажите класс и страну. (таблица classes)

"""

#task4
request = """
select *
from ships

join classes
on ships.class = classes.class
where bore >= 16

"""
pd.read_sql_query(request, conn)

"""Задание 5: Укажите корабли, потопленные в сражениях в Северной Атлантике (таблица Outcomes, North Atlantic). Вывод: ship."""

#task5
request = """
select ship
from Outcomes
where battle = 'North Atlantic' and
result = 'sunk'
"""
pd.read_sql_query(request, conn)

"""Задание 6: Вывести название (ship) последнего потопленного корабля"""

#task6
request = """
select ship
from Outcomes o
join battles b
on o.battle = b.name
where b.date = (select max(date)
from Outcomes o 
join battles b
on o.battle = b.name
where result = 'sunk')
and result = 'sunk'
"""
pd.read_sql_query(request, conn)

"""Задание 7: Вывести название корабля (ship) и класс (class) последнего потопленного корабля"""

#task7
request = """
select ship, class
from Outcomes o
join battles b
on o.battle = b.name
join ships s
on o.ship = s.name
where b.date = (select max(date)
from Outcomes o
join battles b
on o.battle = b.name
join ships s
on o.ship = s.name
where result = 'sunk')
and result = 'sunk'

"""
pd.read_sql_query(request, conn)

"""Задание 8: Вывести все потопленные корабли, у которых калибр орудий не менее 16, и которые потоплены. Вывод: ship, class

"""

#task8
request = """
select ship, s.class
from Outcomes o
join battles b
on o.battle = b.name
join ships s
on o.ship = s.name
join Classes c
on s.class = c.class
where bore >= 16
and result = 'sunk'





"""
pd.read_sql_query(request, conn)

"""Задание 9: Вывести все классы кораблей, выпущенные США (таблица classes, country = 'USA'). Вывод: class

"""

#task9
request = """
select DISTINCT c.class
from Classes c
where country = 'USA'
"""
pd.read_sql_query(request, conn)

"""Задание 10: Вывести все корабли, выпущенные США (таблица classes & ships, country = 'USA'). Вывод: name, class"""

#task10
request = """
select name, c.class
from ships s 
join Classes c
on s.class = c.class
where country = 'USA'
"""
pd.read_sql_query(request, conn)

